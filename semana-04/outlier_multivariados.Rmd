---
title: "R Notebook"
output: html_notebook
---


#########################################################
#  An?lisis Multivariado de Valores Extremos            #
#########################################################


```{r}
#-------------------------------------------------------#
# Ejemplo: Outliers en dos dimensiones                  #
#-------------------------------------------------------#

load(file = "simpleExample.rda")
#load(file.choose())
head(dat)
tail(dat)
summary(dat)
```


```{r}
par(mfrow=c(1,3))
plot(dat, xlim = c(-5,5), ylim = c(-5,5))
barplot(dat[,1], main="Valores de X")
barplot(dat[,2], main="Valores de Y")
par(mfrow=c(1,1))
```
Se usa un grafico de barras a pesar que son variables cualitativas. 
El diagrama de dispersion solo es util hasta con 2 variables, es decir graficamente podemos hacer el analisis visualmente.

```{r}
par(mfrow=c(1,3))
plot(dat, xlim = c(-5,5), ylim = c(-5,5))
boxplot(dat[,1],main="Valores de X")
boxplot(dat[,2],main="Valores de y")
par(mfrow=c(1,1))
```
Se obseva un outlier en la primera grafica , aproximadamente en la posicion (-3,3)

# Cuando tengo mas de 2 variables ya no se puede buscar los outliers visualmente

```{r}
# Distancia de Mahalanobis
cm <- colMeans(dat)
S <- cov(dat)
dm <- sqrt(apply(dat, 1, function(x) t(x-cm) %*% solve(S) %*% (x-cm)))

# Matriz de varianza covarianza
S
```
```{r}
# Distancia de Mahalanobis cuadrada
d <- dm^2

# Se visualiza el valor calculado
d
```


```{r}
# Se obtine el valro de mahalanobis al cuadrado
d <- mahalanobis(dat, cm, S)
d
```



```{r}
barplot(d, main="Mahalanobis")
which.max(d)
```

